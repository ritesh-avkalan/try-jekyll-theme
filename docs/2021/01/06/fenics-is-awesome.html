<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name = "keywords" content = "fenics, topology optimization, isogeomtric analysis, hpc, phd blog, paraview, latex, computational mechanics, phd tools, parallel computation, python, phase field fracture, phase field topology optimization" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<meta name="generator" content="Jekyll v4.3.4" />
<meta property="og:title" content="FEniCS is incredible" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="I have been using FEniCS in my research for the past two years, and I have to say that it is just pure gold in scientific computing with differential equations. It helps you think way beyond the constructions of domain-specific implementations of finite element method. You will not understand its powers until you have faced difficulties with commercial packages like Abaqus or Ansys or have tried to make your custom implementation in some programming language." />
<meta property="og:description" content="I have been using FEniCS in my research for the past two years, and I have to say that it is just pure gold in scientific computing with differential equations. It helps you think way beyond the constructions of domain-specific implementations of finite element method. You will not understand its powers until you have faced difficulties with commercial packages like Abaqus or Ansys or have tried to make your custom implementation in some programming language." />
<link rel="canonical" href="/2021/01/06/fenics-is-awesome.html" />
<meta property="og:url" content="/2021/01/06/fenics-is-awesome.html" />
<meta property="og:site_name" content="Abhinav Gupta" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2021-01-06T00:00:00+05:30" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="FEniCS is incredible" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2021-01-06T00:00:00+05:30","datePublished":"2021-01-06T00:00:00+05:30","description":"I have been using FEniCS in my research for the past two years, and I have to say that it is just pure gold in scientific computing with differential equations. It helps you think way beyond the constructions of domain-specific implementations of finite element method. You will not understand its powers until you have faced difficulties with commercial packages like Abaqus or Ansys or have tried to make your custom implementation in some programming language.","headline":"FEniCS is incredible","mainEntityOfPage":{"@type":"WebPage","@id":"/2021/01/06/fenics-is-awesome.html"},"url":"/2021/01/06/fenics-is-awesome.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/css/main.css" type="text/css" media="all" />




  <link rel="shortcut icon" type="image/x-icon" href="/?" />
    <title> 
     
      FEniCS is incredible | 
    
    Abhinav Gupta
  </title>


  <!-- MailerLite Universal -->
  <script>
      (function(w,d,e,u,f,l,n){w[f]=w[f]||function(){(w[f].q=w[f].q||[])
      .push(arguments);},l=d.createElement(e),l.async=1,l.src=u,
      n=d.getElementsByTagName(e)[0],n.parentNode.insertBefore(l,n);})
      (window,document,'script','https://assets.mailerlite.com/js/universal.js','ml');
      ml('account', '325878');
  </script>
  <!-- End MailerLite Universal --><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Abhinav Gupta" /></head><body class="full_width_container"><div class="navbar-container">
    <div class="primary_container ">
        <a class="link home-icon" href="">
                <svg width="76px" height="100%" viewBox="0 0 63 40" >
                    <path d="M29.585,14.07l0.085,1.138l8.46,19.638l0.896,0.906c0.279,0.125 0.564,0.243 0.854,0.355c2.201,0.852 4.618,1.284 7.253,1.284c5.057,0 9.628,-1.101 13.717,-3.286l0.925,-1.544l0,-15.928l-1.75,-1.75l-11.924,0l-1.75,1.75l0,5.016l1.75,1.75l4.63,0c0,0 0,4.518 0,4.518c-0.594,0.254 -1.239,0.453 -1.934,0.6c-1.134,0.24 -2.34,0.358 -3.62,0.358c-1.348,0 -2.57,-0.236 -3.66,-0.726c-1.083,-0.487 -2.014,-1.154 -2.792,-2.005c-0.789,-0.862 -1.394,-1.888 -1.826,-3.07c-0.446,-1.225 -0.664,-2.566 -0.664,-4.021c0,-1.332 0.216,-2.577 0.656,-3.734c0.431,-1.132 1.037,-2.125 1.825,-2.974c0.777,-0.837 1.706,-1.49 2.786,-1.963c1.095,-0.48 2.321,-0.711 3.675,-0.711c1.37,0 2.671,0.226 3.901,0.683c1.182,0.438 2.192,1.054 3.02,1.859l2.463,-0.025l4.092,-4.136l-0.078,-2.536c-1.849,-1.651 -3.946,-2.797 -6.29,-3.44c-2.228,-0.612 -4.611,-0.921 -7.152,-0.921c-2.635,0 -5.052,0.432 -7.253,1.284c-2.243,0.867 -4.172,2.106 -5.792,3.71c-1.617,1.601 -2.887,3.534 -3.802,5.804c-0.275,0.683 -0.509,1.388 -0.701,2.117Z" style="fill-rule:nonzero;"/><path d="M16.141,3.21l-1.604,1.052l-13.552,31.152l1.604,2.448l6.204,0l1.628,-1.107l2.379,-6.021c-0,0 11.141,0 11.141,0c-0,0 2.46,6.038 2.46,6.038l1.62,1.09l6.336,0l1.608,-2.442l-13.42,-31.152l-1.608,-1.058l-4.796,0Zm4.507,19.272l-4.597,0c0,0 2.32,-6.017 2.32,-6.017l2.277,6.017Z" style="fill-rule:nonzero;"/>
                </svg>
        </a>
        <div class="navbar align_menu" style="font-family: Montserrat; font-weight:500">
            <a class="link" href="/pages/blog">Articles</a>
            <a class="link" href="/pages/projects">Projects</a>
            <a class="link nav_desktop" href="/pages/newsletters">Newsletter</a>
            <a class="link" href="/pages/about">About</a>
            <a href="/2021/01/06/fenics-is-awesome.html" id="theme-toggle" onclick="modeSwitcher()" style="cursor: pointer;">Dark</a>
        </div>
    </div>
</div><main aria-label="Content">
        <div>
            <div class="post_container">
    <div class="post_item_left" style=" padding-bottom:50px; ">
        <div class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

            <head>
                <title>FEniCS is incredible</title>
                <script type="text/x-mathjax-config">
                    MathJax.Hub.Config({
                    extensions: ["tex2jax.js"],
                    jax: ["input/TeX", "output/HTML-CSS"],
                    tex2jax: {
                      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                      processEscapes: true
                    },
                    "HTML-CSS": { availableFonts: ["TeX"] }
                  });
                </script>
                <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
            </head>
            <header class="post-header" style="margin-bottom: 60px;">
                <h1 style="font-weight:600; font-size: 46px; margin-top: 120px; " class="post-title p-name" itemprop="name headline">
                    FEniCS is incredible
                </h1>
                <p class="post-meta" style="font-size: 16px;">
                    <time class="dt-published" datetime="2021-01-06T00:00:00+05:30" itemprop="datePublished">Jan 6, 2021
                    </time><span style="padding-left:10px;padding-right: 10px;">|</span><span class="post-meta"><a style="font-size:14px;color: var(--text-color);" href="/categories/coding">CODING</a></span><!-- --------------------------------------- -->
                </p>
            </header>
            <hr style="/*position: relative; width: 300%;right:calc(200% - 30px);*/ background: var(--color-1);border: none;height: 1px; margin-bottom: 80px; opacity: 1;">
            <div class="post-content e-content enlarged-char" itemprop="articleBody">
                <p>I have been using FEniCS in my research for the past two years, and I have to say that it is just pure gold in scientific computing with differential equations. It helps you think way beyond the constructions of domain-specific implementations of finite element method. You will not understand its powers until you have faced difficulties with commercial packages like Abaqus or Ansys or have tried to make your custom implementation in some programming language.</p>

<p>Now, donâ€™t get me wrong. Commercial packages are fantastic to carry out FE simulations using established FEM frameworks rapidly. I have used Abaqus and similar commercial packages for seven years in my research work at the Department of Atomic Energy. But, once you start to implement your custom formulations, it becomes too difficult and overly restrained to code them with the tools provided in commercial packages.</p>

<p>On the other hand, coding your custom implementation gives you a greater understanding of the whole structure of FEM and the coding principles. But, when you start to add complex functionalities into your code, like optimizing for speed, storage, ram usage, and many more things that are automatically handled in commercial packages, you start to feel the burden. These shortcomings, may also significantly hamper the progress of your research. Also, there is always a chance of mistake in custom implementation that might go unnoticed until you arrive at the problem.</p>

<p>In here comes well maintained open-source libraries that are thoroughly tested by the open-source community. They bring in the best of both worlds. You have significant control over your implementation and, at the same time, have access to inbuilt functionalities that are at par with commercial packages.</p>

<p>If you have ever worked with any programming languages, you might have used specific libraries to carry out a particular set of tasks for you. Like in Python, we use NumPy, which is a community maintained library to perform matrix manipulations. This library is highly efficient and provides access to various methods to work with matrices efficiently.  Numpy mimics the functionality of the popular software package MATLAB but gives it in open source so that anyone can work with it without purchasing any licenses.</p>

<blockquote>
  <p>From an accuracy and reliability point of view, using well maintained open-source libraries to perform scientific computation is perfectly fine.</p>
</blockquote>

<p>From an accuracy and reliability point of view, using well maintained open-source libraries to perform scientific computation is perfectly fine. These packages follow rigorous procedures to maintain the code and are designed based on sound software design principles. Many such libraries are frequently used in research.</p>

<p>FEniCS is one such library, that is maintained by a passionate group of researchers. I love working with FEniCS so much because my research deals with differential equations that are still not built into the commercial packages, and coding them entirely on my own would have taken a significant amount of time.</p>

<p>With FEniCS, I get the following benefits.</p>

<h3 id="1-easy-conversion-of-differential-equations-to-discrete-form">1. Easy conversion of differential equations to discrete form</h3>

<p>Suppose I have to code my custom implementation for a particular finite element form (say the bar problemâ€™s finite element form). In that case, I have to first start from the variational-form to the weak-form and then derive the discrete-form. Once I have the discrete system, I have to code the whole system into my computer, which usually is of the form</p>

\[K= \int B^TDBdx\]

\[F=\int N^T F dx\]

<p>And then, I have to code the whole FEM framework, which includes calculation of Jacobians and performing integration with Gauss Quadrature.</p>

<p>Whereas in FEniCS, I can give in the GDE or the weak form, and FEniCS will assemble the whole system for me. I can not stress enough how huge this is. Under the hood, this thing is not as simple as performing symbolic calculations with, say, sympy. Based on the differential equation, the mesh, and the element type you have chosen for the mesh, FEniCs will give you the assembled K matrix and F vector in just under ten lines.</p>

<p>This kind of coding could easily take 100â€™s if not thousands of lines worth of code in a custom implementation.</p>

<h3 id="2-fenics-is-parallel">2. FEniCS is parallel</h3>

<p>Handling a large structural system necessitates parallel computing, and anyone who has written any parallel code understands the complexity that comes with parallelization. FEniCS by design is parallel and thus allows the user to run the same code on parallel systems. Once you get a hold of parallel computing, it is tough to go serial. FEniCS has forced me to better understand parallel computation, and I have made blog posts about it that you can read <a href="https://computationalmechanics.in/parallelizing-for-loop-in-python-with-mpi/">here</a> or <a href="https://computationalmechanics.in/parallel-computing-with-fenics/">here</a>. Going parallel on workstation could give you a significant reduction in run times with FEniCS. I have achieved upto 10X reduction, and the simulation that initially took ten days to complete in the serial was completed in one day on parallel. Achieving such a kind of scalability is very hard with custom codes.</p>

<h3 id="3-fenics-is-designed-for--hpc">3. FEniCS is designed for  HPC</h3>

<p>FEniCS utilizes PeTSc as its linear algebra backend and supports output in XDMF format, which can handle TBâ€™s of data without corruption. Thus, as mentioned on their site, we can code our implementation on our laptops and that same code would work on the workstation or computational clusters that supports HPC. Moreover, the input and output is also supported in parallel with XDMF.</p>

<h3 id="4-fenics-is-based-on-mixed-programming">4. FEniCS is based on mixed programming.</h3>

<p>This one has got to be my favorite. The computational engine of FEniCS is written in C++, and the front end supports coding in Python. Personally, Iâ€™m not too fond of compiled languages. I believe that they are not useful for non-CS researchers in the initial stage of research. Any language comes with two costs.</p>

<ul>
  <li>Programming cost:  The amount of time that it takes to code with the language</li>
  <li>Runtime cost: The amount of time it takes to run the program written with the language</li>
</ul>

<p>Compiled languages such as FORTRAN, C++ win in the runtime speed and run significantly faster than interpreted languages. But, programming with compiled languages is too tedious and takes away all the fun from coding.</p>

<blockquote>
  <p>In the initial stages of designing or developing an algorithm, you should use interpreted languages, and once the design is perfected, shift to compiled.</p>
</blockquote>

<p>Since most of the heavy lifting for designing a sound parallel implementation is carried out by the FEniCS developers, researchers using it could benefit from the speed of C++ while coding their implementation in Python.</p>

<h3 id="5-fenics-has-one-of-the-best-documentation-in-opensource">5. FEniCS has one of the best documentation in opensource</h3>

<p>FEniCS is under active development and has a strong support community, which is quite active on <a href="https://fenicsproject.discourse.group">discourse</a>. If you ever get any kind of doubts regarding FEniCS, you can ask them in the discourse.</p>

<p>In the end, I would like to say that if anyone is at an intermediate level in their understanding of the FEM and have gone through the linear algebra courses by Dr. Gilbert Strang, they should seriously consider FEniCS for their research. You will surely get an even better understanding of the method and coding finite element.</p>

            </div>
            <div class="PageNavigation">
                
                <a class="button button-prev" href="/2021/01/05/setup-Typora.html" title="How to setup Typora for daily journaling">&laquo; Previous</a>
                
                
                <a class="button button-next" href="/2021/01/10/circumradius-fenics.html" title="How to get hmin for each cell in FEniCS">Next &raquo;</a>
                
            </div>
            <!-- ----------------------------------------------------------- -->
            <hr style="/*position: relative; width: 300%;right:calc(200% - 30px);*/ background: var(--color-1);border: none;height: 1px; margin-bottom: 80px; opacity: 1;">
            <div class="flexbox_container_two_col flexbox_container_flip " style="padding-top: 50px;padding-bottom: 50px;">
                <div class="flexbox_item">
                    <div>
                        <p style="font-size:36px; font-family: Montserrat; font-weight: bold; line-height: 1.2; ">Newsletter</p>
                        <p style="font-size:16px; padding-top: 20px; padding-bottom: 30px;">"<em><strong>Quality Research:</strong> A weekly newsletter covering ideas and tools for better academic research.</em>" </p>
                        <a class="ml-onclick-form button button-hello" href="javascript:void(0)" onclick="ml('show', 'uSsXyN', true)">Try the free newsletter</a>
                    </div>
                </div>
                <div class="flexbox_item">
                    <div class="abhi-icon" style="vertical-align: middle;     float: right;"><object data="/assets/svg/newsletter.svg" width="80%" style="pointer-events: none;"> </object></div>
                </div>
            </div>
            <!-- ----------------------------------------------------------- -->
        </div>
    </div>
    <div class="post_item_right hide_mobile">
        <p style="padding-top:200px; font-size: 14px; font-family: Montserrat;">ABOUT THE AUTHOR</p>
        <hr style="/*position: relative; width: 300%;right:calc(200% - 30px);*/ background: var(--color-1);border: none;height: 1px; margin-bottom: 40px;">
        <p style="margin-bottom:20px;font-size: 14px;">Hi, I am <strong>Abhinav Gupta</strong>. I am a researcher at Vanderbilt University, USA. I create content to help you become effective in producing quality research. If you are interested in research, academia, or computational mechanics, make sure to follow me. </p>
        <div style="margin-top:50px;">
            <ul class="social-media-list" style="font-size: 14px;">
                <li>
                    <a class="black-link" href="https://www.linkedin.com/in/abhiguptaio/" target="_blank" rel="noopener noreferrer">[LinkedIn]</a>
                </li>
                <li>
                    <a class="black-link" href="https://github.com/iitrabhi" target="_blank" rel="noopener noreferrer"> [Github]</a>
                </li>
                <li>
                    <a class="black-link" href="https://www.researchgate.net/profile/Abhinav_Gupta52" target="_blank" rel="noopener noreferrer">[RG]</a>
                </li>
                <li>
                    <p>ðŸ‘‹</p>
                </li>
            </ul>
        </div>
        <a class="hover_highlight" style="font-size: 14px;" href="/pages/about">Click here to learn more â†’</a>
        <p style="margin-bottom:50px"></p>
    </div>
</div>
        </div>
    </main>
<div style="min-height: 500px;background-color: #000; width:100%">
    <div class="primary_container">
        <div style="flex: 60%; ">
            <p style="font-family:Montserrat; color:#fff; font-weight:700; margin-top: 50px;">ABHI GUPTA</p>
        </div>
        <div class="hide_mobile" style="flex: 20%;">
            <p style="font-family:Montserrat; color:#888; font-weight:700; margin-top: 50px;">Categories</p>
             <p><a href="/categories/coding"  style="color:#ddd; font-size: 16px;">Coding</a></p>
            <p><a href="/categories/presentation"  style="color:#ddd;font-size: 16px;">Presentation</a></p>
            <p><a href="/categories/productivity"  style="color:#ddd;font-size: 16px;">Productivity</a></p>
        </div>
        <div style="flex: 20%; ">
            <p style="font-family:Montserrat; color:#888; font-weight:700; margin-top: 50px;">Links</p>
           
            <p><a href="https://twitter.com/abhiguptaio"  style="color:#ddd;font-size: 16px;">Twitter</a></p>
            <p><a href="https://www.youtube.com/channel/UCpj8oznjjLwVe5KHOGNrvnQ" style="color:#ddd;font-size: 16px;">YouTube</a></p>

             <p><a href="https://github.com/iitrabhi" style="color:#ddd;font-size: 16px;">GitHub</a></p>
             <p><a href="https://www.linkedin.com/in/abhiguptaio/"  style="color:#ddd;font-size: 16px;">LinkedIn</a></p>

            <p><a href="https://scholar.google.com/citations?user=UfWvIkEAAAAJ"  style="color:#ddd;font-size: 16px;">Google Scholar</a></p>
            <p><a href="https://www.researchgate.net/profile/Abhinav-Gupta-38"  style="color:#ddd;font-size: 16px;">Research Gate</a></p>
            
        </div>
    </div>
</div>
<script src="/assets/js/mode_switcher.js" type="text/javascript"></script>
    <script src="/assets/js/code_block.js" type="text/javascript"></script>
</body>

</html>